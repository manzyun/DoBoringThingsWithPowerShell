## 退屈なことはPowerShellにやらせてもいいか

2019-07-26

CLR/H #109

Hidetsugu TAKAHASHI a.k.a manzyun

---

### はじめに - ご容赦ください

+ 就業の**合間**クオリティです。
+ 「軽い気持ちでPowerShellで爪楊枝未満ツール作ろう」がモットーです。
  + 凝った話はしないはず
  + PowerShellスクリプトの書き方は各自で

---

### スピーカー紹介

高橋秀羅（たかはし　ひでつぐ）

+ しがない放浪（派遣）プログラマ
+ C♯, VB.net, PHP, Python, JavaScript, Go とか
+ 2019年にもなって、作れるWebページは2000年代なデザイン
+ CoderDojoの駄メンター

インターネッツでは「まんじゅ（́ん｀）」というふざけた名前で出没。

---

### PowerShellとは？

+ Windowsに *限らず* 使えるシェル。
+ しかしWindowsや.NETのオブジェクトの問い合わせに対しては *とてつもなく優秀*。
+ 後でもっと詳しい話があると思います。

---

### もう少しほめる

+ 一部のコマンドが、Unix, Linuxでのコマンドでも呼び出せる。
+ Windowsや.NETのオブジェクトには*とてつもなく*使える。
+ 作法は違うものの、Linuxで鍛えたCLIオペレーションの感覚がPowerShellにも応用ができる。

---

### CLIオペレーションの基本の「キ」

+ Windowsエクスプローラーで見ているディレクトリと、CLIで見ているディレクトリは違います
  + エクスプローラーで開いているところに移動するには、CLIでコマンドを入れて移動しなければいけない
+ 何かコマンドを入れてあげないと、何も返事をしてくれません
  + フォルダの中を見るのにもコマンド入力

---

# Demoる？

---

### 「CLIオペレーションの何がいいの？」

**パイプライン処理を組める**

---

### 「パイプライン処理が組めると何がいいの？」

**コマンドからコマンドにデータのバケツリレーができる**

---

### 「データのバケツリレーができると何がいいの？」

スクリプトが組める。

（間違えた表現をあえてすると）**マクロが組める。**

---

### 「で、CLIオペレーションの何がいいの？」

マウスポチポチのWindowsでの作業が**自動化**できる。

---

## 退屈なことはPowerShellにやらせてもいいか

2019-07-26

CLR/H #109

Hidetsugu TAKAHASHI a.k.a manzyun

---

### マウスポチポチ作業の怖いこと

+ 作業ミスが発生する
+ 同じ作業を単調にやるので飽きる
+ 最悪、多大な時間をかけて腱鞘炎などのリスクを高めることになる

と、ちょっと大げさに言いました

---

### PowerShellの基本的な使い方

---

# Demoる？

使い方に関してはインターネッツでも上質な情報が出回っていますし。

---

### PowerShellのあんな使い方、こんな使い方

+ 割と普通と思われる使い方
+ 昔の業務でやったやつに似たやつ
+ 手前味噌の業務中に作ったやつに似たやつ

---

### 割と普通と思われる使い方

商品の在庫状況を書いた、列名を書いた行も入っているShift-JISエンコードのCSVファイル `stock.csv` があるが、中身は整列されていない。

このCSVファイルの内容を、在庫の少ないものから上から順番（昇順）に並べたい。

---

#### 割と普通と思われる使い方

```powershell
$stock_data = Import-Csv .\stock.csv -Encoding Default
$stock_data | Sort-Object "残り在庫"

# もしくは以下も可能
Import-Csv .\stock.csv -Encoding Default | Sort-Object "残り在庫"
```

---

### 手前味噌の業務中に作ったやつに似たやつ

`packets.xml` というXMLファイルの中に、`packets` をルート要素とし、 `base64` という要素がいくつかある。この要素の中身をデシリアライズする。
（一部要求をぼかしています）

---

#### 手前味噌の業務中に作ったやつに似たやつ

制作にかけた時間、4時間。短縮された業務時間、24時間以上。

```powershell
[xml](Get-Content packets.xml).base64 | % {[System.Text.Encoding]::Default.Getstring(System.Convert]::FromBase54String($_)}
```

---

### 言いたかったこと

+ 2019年ですが……。
  + CLIの力は素晴らしいぞ！
+ PowerShellの感覚がLINQにも活かせる？

---

### Thank's for listening

+ このスライドは[Git Pitch](https://gitpitch.com/)で作成しました。
+ 再配布は [CC BY-NC 4.0](https://creativecommons.org/licenses/by-nc/4.0/deed.ja)に基づいて許可いたします。
